@model MemberDashboardViewModel
@{
    ViewData["Title"] = "Ana Sayfa";
}

<!-- Stats Cards -->
<div class="row g-4 mb-4">
    <div class="col-md-4">
        <div class="stats-card animate-fadeIn">
            <div class="stats-card-icon green">
                <i class="bi bi-book"></i>
            </div>
            <div class="stats-card-value">@Model.TotalBorrowed</div>
            <div class="stats-card-label">Toplam Ödünç Aldığım</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="stats-card animate-fadeIn">
            <div class="stats-card-icon blue">
                <i class="bi bi-hourglass-split"></i>
            </div>
            <div class="stats-card-value">@Model.ActiveLoanCount</div>
            <div class="stats-card-label">Aktif Ödünç</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="stats-card animate-fadeIn">
            <div class="stats-card-icon orange">
                <i class="bi bi-exclamation-triangle"></i>
            </div>
            <div class="stats-card-value">@Model.OverdueCount</div>
            <div class="stats-card-label">Gecikmiş</div>
        </div>
    </div>
</div>

<!-- Active Loans -->
<div class="custom-table">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5><i class="bi bi-clock me-2"></i>Aktif Ödünçlerim</h5>
        <a href="@Url.Action("MyLoans")" class="btn btn-gradient-primary btn-sm">
            <i class="bi bi-list me-1"></i>Tüm Geçmişi Gör
        </a>
    </div>
    <div class="card-body p-0">
        @if (Model.ActiveLoans.Any())
        {
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>Kitap</th>
                        <th>Ödünç Tarihi</th>
                        <th>Son İade Tarihi</th>
                        <th>Durum</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var loan in Model.ActiveLoans)
                    {
                        <tr class="@(loan.IsOverdue ? "table-danger" : "")">
                            <td>
                                <strong>@loan.BookTitle</strong>
                                <br>
                                <small class="text-muted">@loan.Author</small>
                            </td>
                            <td>@loan.LoanedAt.ToString("dd.MM.yyyy")</td>
                            <td>
                                @loan.DueAt.ToString("dd.MM.yyyy")
                                @if (loan.IsOverdue)
                                {
                                    <br>
                                    <small class="text-danger">
                                        <i class="bi bi-exclamation-circle"></i>
                                        @loan.DaysOverdue gün gecikmiş
                                    </small>
                                }
                            </td>
                            <td>
                                @if (loan.IsOverdue)
                                {
                                    <span class="badge-status overdue">Gecikmiş</span>
                                }
                                else
                                {
                                    <span class="badge-status active">Ödünçte</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="text-center py-5">
                <i class="bi bi-emoji-smile fs-1 text-muted d-block mb-3"></i>
                <h5 class="text-muted">Aktif ödünç kitabınız yok</h5>
                <p class="text-muted">Kütüphaneden kitap ödünç almak için kütüphanecimize başvurun.</p>
                <a href="@Url.Action("SearchBooks")" class="btn btn-gradient-primary">
                    <i class="bi bi-search me-1"></i>Kitap Ara
                </a>
            </div>
        }
    </div>
</div>
